import { Exist, Leaf, dom, ef, root } from "../../meh/index.js";
const ClockView = (com) => {
    const label = new Leaf.String(com, "---");
    new Clock(com, (now) => {
        label.value = now.toLocaleString();
    });
    return ef.main(ef.h1({ style: { fontSize: "2.3rem" } }, label));
};
class Clock extends Exist {
    update;
    timeout = 0;
    constructor(com, update) {
        super(com);
        this.update = update;
        this.next();
    }
    next() {
        if (this.timeout)
            return;
        const now = new Date();
        const msec = now.getTime() % 1000;
        const next = 1000 - msec;
        this.timeout = setTimeout(() => {
            clearTimeout(this.timeout);
            this.timeout = 0;
            this.next();
        }, next);
        this.update(now);
        // log( "Clock", this.timeout, msec, next );
    }
}
dom.create(root, ClockView(root), "body");
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vdHMtc3JjLzExLzAxL2FwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBTyxNQUFNLG9CQUFvQixDQUFDO0FBRXJFLE1BQU0sU0FBUyxHQUFHLENBQUUsR0FBVyxFQUFHLEVBQUU7SUFFbkMsTUFBTSxLQUFLLEdBQUcsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFFLEdBQUcsRUFBRSxLQUFLLENBQUUsQ0FBQztJQUU1QyxJQUFJLEtBQUssQ0FFUixHQUFHLEVBQ0gsQ0FBRSxHQUFHLEVBQUcsRUFBRTtRQUVULEtBQUssQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3BDLENBQUMsQ0FDRCxDQUFDO0lBRUYsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUViLEVBQUUsQ0FBQyxFQUFFLENBQUUsRUFBRSxLQUFLLEVBQUUsRUFBRSxRQUFRLEVBQUMsUUFBUSxFQUFFLEVBQUUsRUFBQyxLQUFLLENBQUUsQ0FDL0MsQ0FBQztBQUNILENBQUMsQ0FBQztBQUVGLE1BQU0sS0FBTSxTQUFRLEtBQUs7SUFJWTtJQUYxQixPQUFPLEdBQVksQ0FBQyxDQUFDO0lBRS9CLFlBQWEsR0FBVyxFQUFZLE1BQStCO1FBRWxFLEtBQUssQ0FBRSxHQUFHLENBQUUsQ0FBQztRQUZzQixXQUFNLEdBQU4sTUFBTSxDQUF5QjtRQUdsRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDYixDQUFDO0lBRVMsSUFBSTtRQUViLElBQUksSUFBSSxDQUFDLE9BQU87WUFBRyxPQUFPO1FBRTFCLE1BQU0sR0FBRyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDdkIsTUFBTSxJQUFJLEdBQUcsR0FBRyxDQUFDLE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBQztRQUNsQyxNQUFNLElBQUksR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBRXpCLElBQUksQ0FBQyxPQUFPLEdBQUcsVUFBVSxDQUV4QixHQUFHLEVBQUU7WUFFSixZQUFZLENBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBRSxDQUFDO1lBQzdCLElBQUksQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO1lBQ2pCLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNiLENBQUMsRUFDRCxJQUFJLENBQ0osQ0FBQztRQUVGLElBQUksQ0FBQyxNQUFNLENBQUUsR0FBRyxDQUFFLENBQUM7UUFFbkIsNENBQTRDO0lBQzdDLENBQUM7Q0FDRDtBQUVELEdBQUcsQ0FBQyxNQUFNLENBQUUsSUFBSSxFQUFFLFNBQVMsQ0FBRSxJQUFJLENBQUUsRUFBRSxNQUFNLENBQUUsQ0FBQyJ9