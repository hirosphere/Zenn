import { defs } from "./defs.js";
import { Nodet } from "./nodet.js";
const log = console.log;
/**  create()  ファクトリー等で組み立てた「構造定義」から実DOMNodeを作成。  */
export const create = (container, def, com_qe, rel_qe) => {
    const com_e = typeof com_qe == "string" ? document.querySelector(com_qe) : com_qe || null;
    const rel_e = typeof rel_qe == "string" ? document.querySelector(rel_qe) : rel_qe || null;
    return new Nodet(container, def, com_e, (rel_e && rel_e.parentElement == com_e) ? rel_e : undefined);
};
export const each = (source, create) => new defs.Each(source, create);
/** エレメントファクトリーのプロキシにあたえる「ハンドラー」の型定義。 */
const createElement = (ns, type, first_part, remain_parts) => {
    return new defs.Element(ns, type, first_part, remain_parts);
};
class Handler {
    ns;
    constructor(ns) {
        this.ns = ns;
    }
    get(target, type) {
        return this.makefn(type);
    }
    fns = new Map;
    makefn(type) {
        if (this.fns.has(type))
            return this.fns.get(type);
        // log( type );
        const fn = (first, ...remain) => createElement(this.ns, type, first, remain);
        this.fns.set(type, fn);
        return fn;
    }
}
const createElementFactory = (ns) => {
    return new Proxy({}, new Handler(ns));
};
/** HTML / SVG エレメントファクトリー */
export const ef = createElementFactory("");
export const sf = createElementFactory("http://www.w3.org/2000/svg");
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWYuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi90cy1zcmMvbWVoL2RvbS9lZi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ2pDLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDbkMsTUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQztBQUd4QixvREFBb0Q7QUFFcEQsTUFBTSxDQUFDLE1BQU0sTUFBTSxHQUNuQixDQUNDLFNBQTJCLEVBQzNCLEdBQWUsRUFDZixNQUEyQixFQUMzQixNQUF3QixFQUVmLEVBQUU7SUFFWCxNQUFNLEtBQUssR0FBb0IsT0FBTyxNQUFNLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFFLE1BQU0sQ0FBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDO0lBQzdHLE1BQU0sS0FBSyxHQUFpQixPQUFPLE1BQU0sSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUUsTUFBTSxDQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUM7SUFFMUcsT0FBTyxJQUFJLEtBQUssQ0FFZixTQUFTLEVBQ1QsR0FBRyxFQUNILEtBQUssRUFDTCxDQUNDLEtBQUssSUFBSSxLQUFLLENBQUMsYUFBYSxJQUFJLEtBQUssQ0FFckMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQ3JCLENBQUM7QUFDSCxDQUFDLENBQUE7QUFFRCxNQUFNLENBQUMsTUFBTSxJQUFJLEdBQUcsQ0FFbkIsTUFBaUMsRUFDakMsTUFBbUMsRUFFbEMsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLElBQUksQ0FFakIsTUFBTSxFQUNOLE1BQU0sQ0FDTixDQUFDO0FBR0Ysd0NBQXdDO0FBR3hDLE1BQU0sYUFBYSxHQUNuQixDQUNDLEVBQXlCLEVBQ3pCLElBQXlCLEVBQ3pCLFVBQXlDLEVBQ3pDLFlBQThCLEVBRWQsRUFBRTtJQUVsQixPQUFPLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxZQUFZLENBQUUsQ0FBQztBQUMvRCxDQUFDLENBQUM7QUFJRixNQUFNLE9BQU87SUFFUztJQUFyQixZQUFxQixFQUFXO1FBQVgsT0FBRSxHQUFGLEVBQUUsQ0FBUztJQUMvQixDQUFDO0lBRUssR0FBRyxDQUFFLE1BQVUsRUFBRSxJQUFhO1FBRXBDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBRSxJQUFJLENBQUUsQ0FBQztJQUM1QixDQUFDO0lBRUQsR0FBRyxHQUFHLElBQUksR0FBd0MsQ0FBRTtJQUVwRCxNQUFNLENBQUUsSUFBYTtRQUVwQixJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFFLElBQUksQ0FBRTtZQUFJLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUUsSUFBSSxDQUFFLENBQUM7UUFFeEQsZUFBZTtRQUVmLE1BQU0sRUFBRSxHQUE4QixDQUFFLEtBQUssRUFBRSxHQUFJLE1BQU0sRUFBRyxFQUFFLENBQUMsYUFBYSxDQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUUsQ0FBQztRQUM3RyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBRSxJQUFJLEVBQUUsRUFBRSxDQUFFLENBQUM7UUFDekIsT0FBTyxFQUFFLENBQUM7SUFDWCxDQUFDO0NBQ0Q7QUFFRCxNQUFNLG9CQUFvQixHQUFHLENBQXVCLEVBQVcsRUFBRyxFQUFFO0lBRW5FLE9BQU8sSUFBSSxLQUFLLENBQUcsRUFBTyxFQUFFLElBQUksT0FBTyxDQUFFLEVBQUUsQ0FBRSxDQUFFLENBQUM7QUFDakQsQ0FBQyxDQUFBO0FBeUJELDZCQUE2QjtBQUU3QixNQUFNLENBQUMsTUFBTSxFQUFFLEdBQUcsb0JBQW9CLENBQTBCLEVBQUUsQ0FBRSxDQUFDO0FBQ3JFLE1BQU0sQ0FBQyxNQUFNLEVBQUUsR0FBRyxvQkFBb0IsQ0FBeUIsNEJBQTRCLENBQUUsQ0FBQyJ9