import { log } from "../meh/index.js";
const ents = Object.entries;
const vals = Object.values;
class Node {
    index;
    path;
    constructor(index, con) {
        this.index = index;
        this.path = (con ? con.path + "-" : "") + index;
    }
}
export class Room extends Node {
    constructor(index, src, con, rooms) {
        super(index, con);
        log(this.path, src.title);
        this.link = `?room=${this.path}`;
        this.mod_path = `./${this.path.replace(/-/g, "/")}.js`;
        rooms[this.path] = this;
    }
    link;
    mod_path;
}
export class Building extends Node {
    constructor(index, src, con, rooms) {
        super(index, con);
        log(this.path, src.caption);
        for (const [pindex, psrc] of ents(src.rooms)) {
            this.parts[pindex] = new Room(pindex, psrc, this, rooms);
        }
    }
    parts = {};
}
export class Block extends Node {
    constructor(index, src, rooms) {
        super(index);
        // log( this.path, "街区" );
        for (const [pindex, psrc] of ents(src.buildings)) {
            this.parts[pindex] = new Building(pindex, psrc, this, rooms);
        }
    }
    parts = {};
}
export class Danchi {
    parts = {};
    constructor(src) {
        for (const [pindex, psrc] of ents(src.blocks)) {
            this.parts[pindex] = new Block(pindex, psrc, this.rooms);
        }
    }
    rooms = {};
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vdHMtc3JjL2thZGFpLWRhbmNoaS0xL21vZGVscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQTBDLEdBQUcsRUFBUSxNQUFNLGlCQUFpQixDQUFDO0FBRXBGLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUM7QUFDNUIsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztBQWlDM0IsTUFBTSxJQUFJO0lBSVc7SUFGcEIsSUFBSSxDQUFVO0lBRWQsWUFBb0IsS0FBbUIsRUFBRSxHQUFZO1FBQWpDLFVBQUssR0FBTCxLQUFLLENBQWM7UUFFdEMsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBRSxHQUFHLEtBQUssQ0FBQztJQUNuRCxDQUFDO0NBQ0Q7QUFFRCxNQUFNLE9BQU8sSUFBSyxTQUFRLElBQUk7SUFFN0IsWUFBYSxLQUFtQixFQUFFLEdBQWdCLEVBQUUsR0FBVSxFQUFFLEtBQW1CO1FBRWxGLEtBQUssQ0FBRSxLQUFLLEVBQUUsR0FBRyxDQUFFLENBQUM7UUFFcEIsR0FBRyxDQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLEtBQUssQ0FBRSxDQUFDO1FBRTVCLElBQUksQ0FBQyxJQUFJLEdBQUcsU0FBVSxJQUFJLENBQUMsSUFBSyxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFFLElBQUksRUFBRSxHQUFHLENBQUcsS0FBSyxDQUFDO1FBRTNELEtBQUssQ0FBRSxJQUFJLENBQUMsSUFBSSxDQUFFLEdBQUcsSUFBSSxDQUFDO0lBQzNCLENBQUM7SUFFRCxJQUFJLENBQVc7SUFDZixRQUFRLENBQVc7Q0FDbkI7QUFFRCxNQUFNLE9BQU8sUUFBUyxTQUFRLElBQUk7SUFFakMsWUFBYSxLQUFtQixFQUFFLEdBQW9CLEVBQUUsR0FBVSxFQUFFLEtBQW1CO1FBRXRGLEtBQUssQ0FBRSxLQUFLLEVBQUUsR0FBRyxDQUFFLENBQUM7UUFFcEIsR0FBRyxDQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBRSxDQUFDO1FBRTlCLEtBQUssTUFBTSxDQUFFLE1BQU0sRUFBRSxJQUFJLENBQUUsSUFBSSxJQUFJLENBQUUsR0FBRyxDQUFDLEtBQUssQ0FBRSxFQUNoRDtZQUNDLElBQUksQ0FBQyxLQUFLLENBQUUsTUFBTSxDQUFFLEdBQUcsSUFBSSxJQUFJLENBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFFLENBQUM7U0FDN0Q7SUFDRixDQUFDO0lBRUQsS0FBSyxHQUFrQyxFQUFFLENBQUM7Q0FDMUM7QUFFRCxNQUFNLE9BQU8sS0FBTSxTQUFRLElBQUk7SUFFOUIsWUFBYSxLQUFtQixFQUFFLEdBQWlCLEVBQUUsS0FBbUI7UUFFdkUsS0FBSyxDQUFFLEtBQUssQ0FBRSxDQUFDO1FBRWYsMEJBQTBCO1FBRTFCLEtBQUssTUFBTSxDQUFFLE1BQU0sRUFBRSxJQUFJLENBQUUsSUFBSSxJQUFJLENBQUUsR0FBRyxDQUFDLFNBQVMsQ0FBRSxFQUNwRDtZQUNDLElBQUksQ0FBQyxLQUFLLENBQUUsTUFBTSxDQUFFLEdBQUcsSUFBSSxRQUFRLENBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFFLENBQUM7U0FDakU7SUFDRixDQUFDO0lBRUQsS0FBSyxHQUFzQyxFQUFFLENBQUM7Q0FDOUM7QUFFRCxNQUFNLE9BQU8sTUFBTTtJQUVsQixLQUFLLEdBQW1DLEVBQUUsQ0FBQztJQUUzQyxZQUFhLEdBQWtCO1FBRTlCLEtBQUssTUFBTSxDQUFFLE1BQU0sRUFBRSxJQUFJLENBQUUsSUFBSSxJQUFJLENBQUUsR0FBRyxDQUFDLE1BQU0sQ0FBRSxFQUNqRDtZQUNDLElBQUksQ0FBQyxLQUFLLENBQUUsTUFBTSxDQUFFLEdBQUcsSUFBSSxLQUFLLENBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFFLENBQUM7U0FDN0Q7SUFDRixDQUFDO0lBRUQsS0FBSyxHQUFpQixFQUFFLENBQUE7Q0FDeEIifQ==