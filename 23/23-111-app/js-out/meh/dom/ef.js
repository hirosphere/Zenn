import { StrSrcFactory } from "../model/index.js";
import { defs } from "./defs.js";
import { Nodet } from "./nodet.js";
const log = console.log;
export const create = (owner, def, ceqsel, rel) => {
    const ce = typeof ceqsel == "string" ? document.querySelector(ceqsel) : ceqsel;
    let nodet = ce && new Nodet(owner, def, ce, rel);
    return { terminate() { nodet?.terminate(); } };
};
const createElementDef = (ns, type, first, ...remain) => {
    if (typeof first == "object") {
        if (first instanceof defs.Element || first instanceof defs.Each || first instanceof StrSrcFactory) {
            return new defs.Element(ns, type, undefined, [first, ...remain]);
        }
        else {
            return new defs.Element(ns, type, first, remain);
        }
    }
    const parts = first !== undefined ? [first, ...remain] : undefined;
    return new defs.Element(ns, type, undefined, parts);
};
//
class Handler {
    ns;
    constructor(ns) {
        this.ns = ns;
    }
    get(target, type) {
        return this.makefn(type);
    }
    fns = new Map;
    makefn(type) {
        if (this.fns.has(type))
            return this.fns.get(type);
        log(type);
        const fn = (first, ...remain) => createElementDef(this.ns, type, first, ...remain);
        this.fns.set(type, fn);
        return fn;
    }
}
const createElementFactory = (ns) => {
    return new Proxy({}, new Handler(ns));
};
export const ef = createElementFactory("");
export const sf = createElementFactory("http://www.w3.org/2000/svg");
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWYuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi90cy1zcmMvbWVoL2RvbS9lZi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQVMsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDekQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUNqQyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBRW5DLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUM7QUFFeEIsTUFBTSxDQUFDLE1BQU0sTUFBTSxHQUFHLENBQUUsS0FBYSxFQUFFLEdBQWtCLEVBQUUsTUFBeUIsRUFBRSxHQUFZLEVBQUcsRUFBRTtJQUV0RyxNQUFNLEVBQUUsR0FBRyxPQUFPLE1BQU0sSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUUsTUFBTSxDQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztJQUVqRixJQUFJLEtBQUssR0FBRyxFQUFFLElBQUksSUFBSSxLQUFLLENBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxDQUFFLENBQUM7SUFFbkQsT0FBTyxFQUFFLFNBQVMsS0FBSyxLQUFLLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUNoRCxDQUFDLENBQUE7QUFjRCxNQUFNLGdCQUFnQixHQUFHLENBQUUsRUFBVyxFQUFFLElBQWEsRUFBRSxLQUFrQixFQUFFLEdBQUksTUFBcUIsRUFBa0IsRUFBRTtJQUV2SCxJQUFJLE9BQU8sS0FBSyxJQUFJLFFBQVEsRUFDNUI7UUFDQyxJQUFJLEtBQUssWUFBWSxJQUFJLENBQUMsT0FBTyxJQUFJLEtBQUssWUFBWSxJQUFJLENBQUMsSUFBSSxJQUFJLEtBQUssWUFBWSxhQUFhLEVBQ2pHO1lBQ0MsT0FBTyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsQ0FBRSxLQUFLLEVBQUUsR0FBSSxNQUFNLENBQUUsQ0FBRSxDQUFDO1NBQ3RFO2FBRUQ7WUFDQyxPQUFPLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUUsQ0FBQztTQUNuRDtLQUNEO0lBRUQsTUFBTSxLQUFLLEdBQUcsS0FBSyxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBRSxLQUFLLEVBQUUsR0FBSSxNQUFNLENBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBQ3RFLE9BQU8sSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLEtBQUssQ0FBRSxDQUFDO0FBQ3ZELENBQUMsQ0FBQTtBQUVELEVBQUU7QUFFRixNQUFNLE9BQU87SUFFUztJQUFyQixZQUFxQixFQUFXO1FBQVgsT0FBRSxHQUFGLEVBQUUsQ0FBUztJQUMvQixDQUFDO0lBRUssR0FBRyxDQUFFLE1BQVUsRUFBRSxJQUFhO1FBRXBDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBRSxJQUFJLENBQUUsQ0FBQztJQUM1QixDQUFDO0lBRUQsR0FBRyxHQUFHLElBQUksR0FBK0UsQ0FBRTtJQUUzRixNQUFNLENBQUUsSUFBYTtRQUVwQixJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFFLElBQUksQ0FBRTtZQUFJLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUUsSUFBSSxDQUFFLENBQUM7UUFFeEQsR0FBRyxDQUFFLElBQUksQ0FBRSxDQUFDO1FBRVosTUFBTSxFQUFFLEdBQUcsQ0FBRSxLQUFnQixFQUFFLEdBQUksTUFBcUIsRUFBRyxFQUFFLENBQUMsZ0JBQWdCLENBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEdBQUksTUFBTSxDQUFFLENBQUM7UUFDbkgsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBRSxDQUFDO1FBQ3pCLE9BQU8sRUFBRSxDQUFDO0lBQ1gsQ0FBQztDQUNEO0FBRUQsTUFBTSxvQkFBb0IsR0FBRyxDQUF1QixFQUFXLEVBQUcsRUFBRTtJQUVuRSxPQUFPLElBQUksS0FBSyxDQUFHLEVBQU8sRUFBRSxJQUFJLE9BQU8sQ0FBRSxFQUFFLENBQUUsQ0FBRSxDQUFDO0FBQ2pELENBQUMsQ0FBQTtBQWNELE1BQU0sQ0FBQyxNQUFNLEVBQUUsR0FBRyxvQkFBb0IsQ0FBMEIsRUFBRSxDQUFFLENBQUM7QUFDckUsTUFBTSxDQUFDLE1BQU0sRUFBRSxHQUFHLG9CQUFvQixDQUF5Qiw0QkFBNEIsQ0FBRSxDQUFDIn0=