import { defs } from "./defs.js";
import { bindText } from "./compo.js";
const log = console.log;
export class Parts {
    compo;
    ce;
    static create(compo, e, partsDef, index = 0) {
        const partDef = partsDef[index];
        if (partDef instanceof defs.LianParts) {
            ;
        }
        else
            new StaticParts(compo, e, partsDef, index);
    }
    //  //
    nodes = new Array;
    next;
    prev;
    constructor(compo, ce) {
        this.compo = compo;
        this.ce = ce;
    }
    createNext(def) {
        ;
    }
    get last() {
        return last(this.nodes) || null;
    }
    createPart(def, ce) {
        if (typeof def == "object" && "isElement" in def) {
            return this.compo.createElement(def, ce);
        }
        const n = document.createTextNode("");
        bindText(n, "nodeValue", def, this.compo.refs);
        ce.appendChild(n);
        return n;
    }
    delete() {
        this.next?.delete();
    }
}
// static parts //
class StaticParts extends Parts {
    constructor(compo, ce, def, partdefindex) {
        super(compo, ce);
        compo.partsList ??= this;
        while (partdefindex < def.length) {
            const partdef = def[partdefindex++];
            const part = this.createPart(partdef, ce);
            this.nodes.push(part);
        }
    }
}
//  dynamic parts //
class DynamicParts extends Parts {
    constructor(compo, ce, def) {
        super(compo, ce);
        def.source.ref(this.update);
    }
    update = (start, remove, add) => {
        log("DynParts update", start, remove, add);
    };
}
function last(arr) {
    return arr[arr.length - 1];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFydHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi90cy1zcmMvbWVoL2RvbS9wYXJ0cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ2pDLE9BQU8sRUFBYSxRQUFRLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFHakQsTUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQztBQUV4QixNQUFNLE9BQWdCLEtBQUs7SUFxQkg7SUFBNkI7SUFuQnBELE1BQU0sQ0FBQyxNQUFNLENBQUUsS0FBaUIsRUFBRSxDQUFXLEVBQUUsUUFBdUIsRUFBRSxRQUFpQixDQUFDO1FBRXpGLE1BQU0sT0FBTyxHQUFHLFFBQVEsQ0FBRSxLQUFLLENBQUUsQ0FBQztRQUVsQyxJQUFJLE9BQU8sWUFBWSxJQUFJLENBQUMsU0FBUyxFQUNyQztZQUNDLENBQUM7U0FDRDs7WUFFSSxJQUFJLFdBQVcsQ0FBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUUsQ0FBQztJQUNuRCxDQUFDO0lBRUQsTUFBTTtJQUVJLEtBQUssR0FBRyxJQUFJLEtBQWMsQ0FBRTtJQUU1QixJQUFJLENBQVc7SUFDZixJQUFJLENBQVc7SUFFekIsWUFBdUIsS0FBaUIsRUFBWSxFQUFZO1FBQXpDLFVBQUssR0FBTCxLQUFLLENBQVk7UUFBWSxPQUFFLEdBQUYsRUFBRSxDQUFVO0lBQy9ELENBQUM7SUFFUSxVQUFVLENBQUUsR0FBaUI7UUFFdEMsQ0FBQztJQUNGLENBQUM7SUFFRCxJQUFXLElBQUk7UUFFZCxPQUFPLElBQUksQ0FBWSxJQUFJLENBQUMsS0FBSyxDQUFFLElBQUksSUFBSSxDQUFDO0lBQzdDLENBQUM7SUFFUyxVQUFVLENBQUUsR0FBZSxFQUFFLEVBQVk7UUFFbEQsSUFBSSxPQUFPLEdBQUcsSUFBSSxRQUFRLElBQUksV0FBVyxJQUFJLEdBQUcsRUFDaEQ7WUFDQyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFFLEdBQUcsRUFBRSxFQUFFLENBQUUsQ0FBQztTQUMzQztRQUVELE1BQU0sQ0FBQyxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUUsRUFBRSxDQUFFLENBQUM7UUFDeEMsUUFBUSxDQUFFLENBQUMsRUFBRSxXQUFXLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFFLENBQUM7UUFDakQsRUFBRSxDQUFDLFdBQVcsQ0FBRSxDQUFDLENBQUUsQ0FBQztRQUVwQixPQUFPLENBQUMsQ0FBQztJQUNWLENBQUM7SUFFTSxNQUFNO1FBRVosSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQztJQUNyQixDQUFDO0NBQ0Q7QUFHRCxrQkFBa0I7QUFFbEIsTUFBTSxXQUFZLFNBQVEsS0FBSztJQUU5QixZQUFhLEtBQWlCLEVBQUUsRUFBWSxFQUFFLEdBQWlCLEVBQUUsWUFBcUI7UUFFckYsS0FBSyxDQUFFLEtBQUssRUFBRSxFQUFFLENBQUUsQ0FBQztRQUVuQixLQUFLLENBQUMsU0FBUyxLQUFLLElBQUksQ0FBQztRQUV6QixPQUFPLFlBQVksR0FBRyxHQUFHLENBQUMsTUFBTSxFQUNoQztZQUNDLE1BQU0sT0FBTyxHQUFHLEdBQUcsQ0FBRSxZQUFZLEVBQUcsQ0FBRSxDQUFDO1lBQ3ZDLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUUsT0FBTyxFQUFFLEVBQUUsQ0FBRSxDQUFDO1lBQzVDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFFLElBQUksQ0FBRSxDQUFDO1NBQ3hCO0lBQ0YsQ0FBQztDQUNEO0FBR0Qsb0JBQW9CO0FBRXBCLE1BQU0sWUFBYSxTQUFRLEtBQUs7SUFFL0IsWUFBYSxLQUFpQixFQUFFLEVBQVksRUFBRSxHQUFvQjtRQUVqRSxLQUFLLENBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBRSxDQUFDO1FBRW5CLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFFLElBQUksQ0FBQyxNQUFNLENBQUUsQ0FBQztJQUMvQixDQUFDO0lBRVMsTUFBTSxHQUFpQixDQUFFLEtBQWMsRUFBRSxNQUFlLEVBQUUsR0FBWSxFQUFHLEVBQUU7UUFFcEYsR0FBRyxDQUFFLGlCQUFpQixFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsR0FBRyxDQUFFLENBQUM7SUFDOUMsQ0FBQyxDQUFBO0NBQ0Q7QUFFRCxTQUFTLElBQUksQ0FBUyxHQUFpQjtJQUV0QyxPQUFPLEdBQUcsQ0FBRSxHQUFHLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBRSxDQUFDO0FBQzlCLENBQUMifQ==